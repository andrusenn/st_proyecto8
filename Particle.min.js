class Particle{constructor(s,i){this.pos={x:s,y:i},this.x=s,this.y=i,this.ipos={x:s,y:i},this.vel={x:0,y:0},this.maxDil=20,this.angle=0,this.sangle=0,this.dir={x:0,y:0},this.off=0,this.mult=.5,this.noise=0,this.noise_size=.003,this.offc=0,this.data={},this.snap,this.snaplen=40,this.count=0,this.shake=!1}update(s){this.noise=s(this.pos.x*this.noise_size,this.pos.y*this.noise_size,this.off);let i=this.maxDil;if(this.snap||(this.angle=this.noise*TAU*i-this.sangle),this.snap&&this.count%this.snaplen==0&&(this.angle=this.noise*TAU*i-this.sangle),random()<.5&&this.shake&&(this.angle*=-10),this.dir.x=cos(this.angle),this.dir.y=sin(this.angle),this.snap){let s=round(this.angle/this.snap)*this.snap;this.dir.x=cos(s),this.dir.y=sin(s)}this.vel.x+=this.dir.x,this.vel.y+=this.dir.y,this.vel.x*=this.mult,this.vel.y*=this.mult,this.pos.x+=this.vel.x,this.pos.y+=this.vel.y,this.off+=this.offc,this.x=this.pos.x,this.y=this.pos.y,this.count++}reset(){this.pos.set(this.ipos)}}